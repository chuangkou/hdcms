<load file="__CONTROL_TPL__/header.html"/>
</head>
<script>
    $(function () {
        $("form").submit(function () {
            if (!$(this).attr("target")) {
                if (!$("input[name='title']").val()) {
                    alert("标题不能为空");
                    return false;
                }
                if ($("select[name='cid'] option:selected").attr('lab') == 1) {
                    alert("栏目不能为频道封面，请更改");
                    return false;
                }
                if (!UE.getEditor('content').getContent()) {
                    alert("内容不能为空");
                    return false;
                }
            }
        })
    })
</script>
<body>
<form action="{|U:edit}" method="post" id="form" enctype="multipart/form-data">
    <input type="hidden" name="mid" value="{$field.mid}"/>
    <input type="hidden" name="aid" value="{$field.aid}"/>
    <div class="right_content">
        <div class="tab">
            <ul class="tab_menu">
                <li lab="base"><a href="#base">发表文章</a></li>
            </ul>
            <div class="tab_content">
                <div id="base" class="con">
                    <table class="table">
                        <tr>
                            <th width="100">标题</th>
                            <td>
                                <input type="text" name="title" class="title w400" value="{$field.title}" <if value="$field['color']">style="color:{$field.color}"</if>/>
                                标题颜色：<input type="text" name="color" class="w100" value="{$field.color}"/>
                                <button type="button" onclick="select_color(this,'color')">选取颜色</button>
                            </td>

                        </tr>
                        <tr>
                            <th>属性</th>
                            <td>
                                <list from="$flag" name="fl">
                                    <label>
                                        <input type="checkbox" name="flag[]" value="{$fl.fid}"
                                        <if value="in_array($fl['fid'],$field['flag'])">checked="checked"</if>
                                        />
                                        {$fl.flagname}[{$fl.fid}]
                                    </label>
                                </list>
                            </td>

                        </tr>
                        <tr>
                            <th>栏目</th>
                            <td>
                                <select name="cid">
                                    <list from="$category" name="cat">
                                        <option value="{$cat.cid}"
                                        <if value="$cat['cid']==$field['cid']">selected="selected"</if> lab="{$cat.type}" <if value="$cat['type']==1">style="background:#3A6EA5;color:#fff;"</if>
                                        >
                                        <if value="$cat.pid!=0">└</if>{$cat.html}{$cat.catname}<if value="$cat['type']==1">(频道封面)</if>
                                        </option>
                                    </list>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <th>缩略图</th>
                            <td>
                                <table border="0">
                                    <tr>
                                        <td>
                                            <input type="text" name="thumb" class="w300" id="thumb"
                                                   value="{$field.thumb}"/>
                                            <span class="thumb">
                                            <input type="file" name="thumb_file" class="upload_thumb"
                                                   onchange="img_upload(this,'{|U:thumbUpload}','img_target','thumb','thumbpic')"/>
                                            </span>
                                            <iframe name="img_target" style="display:none;"></iframe>
                                        </td>
                                        <td>
                                            <div class="thumbpic">
                                                <img src="__ROOT__/{$field.thumb}" width="150"/>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <th>来源</th>
                            <td>
                                <input type="text" name="source" class="w150" value="{$field.source}"/>
                                作者:
                                <input type="text" name="author" class="w150" value="{$field.author}"/>
                            </td>

                        </tr>
                        <tr>
                            <th>跳转地址</th>
                            <td>
                                <input type="text" name="redirecturl" class="w300" value="{$field.redirecturl}"/>
                            </td>

                        </tr>
                        <if value="$field['keywords']">
                            <tr>
                                <th>关键字</th>
                                <td>
                                    <input type="text" name="{$model.tablename}_data[keywords]" class="w400"
                                           value="{$field.keywords}"/>
                                </td>

                            </tr>
                        </if>
                        <if value="$field['description']">
                            <tr>
                                <th>内容摘要</th>
                                <td>
                                    <textarea name="{$model.tablename}_data[description]"
                                              style="width:500px;height:70px;">{$field.description}</textarea>
                                </td>

                            </tr>
                        </if>
                        <if value="$field['content']">
                            <tr>
                                <th>内容</th>
                                <td>
                                    <script id="content" name="{$model.tablename}_data[content]"
                                            type="text/plain">{$field.content}</script>
                                    <script type='text/javascript'>
                                        var ue = UE.getEditor('content', {
                                            imageUrl: '{|editor_upload_img}'//处理上传脚本
                                            , zIndex: 0, autoClearinitialContent: false, initialFrameWidth: "100%" //宽度1000
                                            , initialFrameHeight: "300" //宽度1000
                                            , autoHeightEnabled: false //是否自动长高,默认true
                                            , autoFloatEnabled: false //是否保持toolbar的位置不动,默认true
                                            , maximumWords: 2000 //允许的最大字符数
                                            , initialContent: '' //初始化编辑器的内容 也可以通过textarea/script给值
                                        });
                                    </script>
                                </td>
                            </tr>
                        </if>
                        <tr>
                            <th>生成静态</th>
                            <td>
                                <input type="radio" name="ishtml" value="1" <if value="$field['ishtml']==1">checked="checked"</if>/> 是
                                <input type="radio" name="ishtml" value="2" <if value="$field['ishtml']==0">checked="checked"</if>/> 否
                            </td>
                        </tr>
                        <tr>
                            <th>允许回复</th>
                            <td>
                                <input type="radio" name="allowreply" value="1" <if value="$field['allowreply']==1">checked="checked"</if>/> 允许
                                <input type="radio" name="allowreply" value="0" <if value="$field['allowreply']==0">checked="checked"</if>/> 不允许
                            </td>
                        </tr>
                        <tr>
                            <th>发布时间</th>
                            <td>
                                <input type="text" name="updatetime" id="updatetime" value="{$field.updatetime|date:'Y-m-d',@@}"
                                       class="w200"/>
                                <script>
                                    $(function () {
                                        //日期中文字符
                                        var dateFormat = {
                                            dateFormat: "yy-mm-dd", monthNames: [ "一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月" ], dayNamesMin: [ "日", "一", "二", "三", "四", "五", "六" ]
                                        };
                                        //为ID为begin_time的input设置日历
                                        $("#updatetime").datepicker(dateFormat);
                                    });
                                </script>

                            </td>

                        </tr>
                        <tr>
                            <th>点击</th>
                            <td>
                                <input type="text" name="click" class="w100" value="{$field.click}"/> 次
                            </td>
                        </tr>
                        <list from="$user_field" name="f">
                            {$f.html}
                        </list>
                    </table>
                    <div class="send">
                        <input type="submit" class="btn" name="send" value="确定"/>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
</body>
</html>
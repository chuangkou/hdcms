<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
    <title>文章管理</title>
    <jquery/>
    <jqueryui/>
    <jsconst/>
    <hdui/>
    <js file="__GROUP__/Common/Tpl/Js/article.js"/>
    <css file="__GROUP__/Common/Tpl/Css/article.css"/>
    <!--公共文件-->
    <js file="__GROUP__/Common/Tpl/Js/common.js"/>
    <css file="__GROUP__/Common/Tpl/Css/common.css"/>
    <!--编辑器-->
    <if value="$model.type==1">
        <js file="__HDPHP__/Extend/Org/Editor/Ueditor/ueditor.all.min.js"/>
        <js file="__HDPHP__/Extend/Org/Editor/Ueditor/ueditor.config.js"/>
        <else>
            <?php foreach($user_field as $f):?>
            <?php if($f['show_type']=='editor'):?>
            <js file="__HDPHP__/Extend/Org/Editor/Ueditor/ueditor.all.min.js"/>
            <js file="__HDPHP__/Extend/Org/Editor/Ueditor/ueditor.config.js"/>
            <?php break;endif;?>
            <?php endforeach;?>
    </if>
    <script>
        //验证
        $(function () {
            $("form").validation({
                cid: {
                    rule: {
                        required: true
                    },
                    error: {
                        required: "请选择栏目"
                    }
                }
            })
        })
    </script>
</head>
<body>
<form action="{|U:add}" method="post" id="form" enctype="multipart/form-data">
<input type="hidden" name="mid" value="{$hd.get.mid}"/>

<div class="right_content">
<div class="tab">
<ul class="tab_menu">
    <li lab="base"><a href="#">添加文章</a></li>
    <li lab="base2"><a href="{|U:'index',array('mid'=>$_GET['mid'])}">文章列表</a></li>
</ul>
<div class="tab_content" style="border:none;">
<div id="base" class="con">
<table class="table">
<tr>
    <th width="100">标题</th>
    <td>
        <input type="text" name="title" class="title w400"/>

        标题颜色 <input type="text" readonly="readonly" name="color" class="w60"/>
        <button type="button" onclick="selectColor(this,'color')">选取颜色</button>
        <input type="checkbox" name="new_window" value="1"/> 新窗口打开
    </td>

</tr>
<tr>
    <th>属性</th>
    <td>
        <list from="$flag" name="fl">
            <label>
                <input type="checkbox" name="flag[]" value="{$fl.fid}"/>
                {$fl.flagname}[{$fl.fid}]
            </label>
        </list>
    </td>

</tr>
<tr>
    <th>栏目</th>
    <td>
        <select name="cid">
            <option value="">===选择栏目===</option>
            <list from="$category" name="cat">
                <option value="{$cat.cid}"
                <if value="$hd.get.cid && $cat['cid']==$_GET['cid']">selected="selected"</if>
                cattype="{$cat.cattype}"
                <if value="$cat['cattype']==2">style="background:#dadada;color:#333;"</if>
                >
                <if value="$cat.pid!=0">└</if>
                {$cat.html}{$cat.catname}
                <if value="$cat['cattype']==2">(频道封面)</if>
                </option>
            </list>
        </select>
    </td>
</tr>
<tr>
    <th>缩略图</th>
    <td>
        <table border="0">
            <tr>
                <td>
                    <input type="text" readonly="readonly" name="thumb" class="w300"/>
                                            <span class="thumb">
                                            <input type="file" name="thumb_file" class="upload_thumb"
                                                   onchange="thumbUpload(this,'{|U:thumbUpload}','img_target','thumb','thumbpic')"/>
                                            </span>
                    <iframe name="img_target" style="display:none;"></iframe>
                </td>
                <td>
                    <div class="thumbpic"></div>
                </td>
            </tr>
        </table>
    </td>
</tr>
<tr>
    <th>来源</th>
    <td>
        <input type="text" name="source" class="w150"/>
        作者 <input type="text" name="author" class="w150" value="{$hd.session.username}"/>
    </td>

</tr>
<tr>
    <th>跳转地址</th>
    <td>
        <input type="text" name="redirecturl" class="w300"/>
        <span></span>
    </td>
</tr>
<if value="$model.type==1">
    <tr>
        <th>关键字</th>
        <td>
            <input type="text" name="{$model.tablename}_data[keywords]" class="w400"/>
        </td>
    </tr>
    <tr>
        <th>内容摘要</th>
        <td>
            <textarea name="{$model.tablename}_data[description]" style="width:500px;height:70px;"></textarea>
        </td>
    </tr>
    <tr>
        <td colspan="2">
            <table class="table">
                <tr>
                    <td>
                        <table class="table" style="background:#F3F3F3;">
                            <tr>
                                <td width="60" style="padding:6px;">内容选项:</td>
                                <td>
                                    <input type="checkbox" name="editer_image_to_thumb" value="1"
                                           checked="checked"/>
                                    使用第一张图做为缩略图
                                    <input type="checkbox" name="content_image_water" value="1"/> 图片加水印
                                    <br/>
                                    图片最大宽度: <input lab="ueditor_param" type="text"
                                                   name="content_image_width" value="600"
                                                   style="width:50px;"/> px
                                    图片最大高度: <input lab="ueditor_param" type="text"
                                                   name="content_image_height" value="600"
                                                   style="width:50px;"/> px
                                    (图片超过最大宽度或高度将自动缩放)
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td>
                        <script id="content" name="{$model.tablename}_data[content]"
                                type="text/plain"></script>
                        <script type='text/javascript'>
                            var ue = UE.getEditor('content', {
                                imageUrl: '__CONTROL__&m=editorUploadImg&water=0'//处理上传脚本
                                , catcherUrl: '__CONTROL__&m=editorCatcherUrl&water=0'//抓取远程图片
                                , zIndex: 0, autoClearinitialContent: false, initialFrameWidth: "100%" //宽度1000
                                , initialFrameHeight: "300" //宽度1000
                                , autoHeightEnabled: false //是否自动长高,默认true
                                , autoFloatEnabled: false //是否保持toolbar的位置不动,默认true
                                , maximumWords: 2000 //允许的最大字符数
                                , initialContent: '' //初始化编辑器的内容 也可以通过textarea/script给值
                            });
                            //设置编辑器选项
                            function setUeditorParam() {
                                var water = $("input[name='content_image_water']").attr("checked") ? 1 : 0;
                                var width = parseInt($("input[name='content_image_width']").val());
                                var height = parseInt($("input[name='content_image_height']").val());
                                ue.options.imageUrl = '__CONTROL__&m=editorUploadImg&water=' + water + "&width=" + width + "&height=" + height;
                            }
                            $("input[name='content_image_water']").click(function () {
                                setUeditorParam();
                            })
                            $("input[lab='ueditor_param']").blur(function () {
                                setUeditorParam();
                            })
                            setUeditorParam();//初始化
                        </script>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</if>
<tr>
    <th>生成静态</th>
    <td>
        <input type="radio" name="ishtml" value="1" checked="checked"/> 是
        <input type="radio" name="ishtml" value="0"/> 否
    </td>
</tr>
<tr>
    <th>允许回复</th>
    <td>
        <input type="radio" name="allowreply" value="1" checked="checked"/> 允许
        <input type="radio" name="allowreply" value="0"/> 不允许
    </td>

</tr>
<tr>
    <th>发布时间</th>
    <td>
        <input type="text" name="updatetime" id="updatetime" value="{|date:'Y-m-d'}"
               class="w200"/>
        <script>
            $(function () {
                //日期中文字符
                var dateFormat = {
                    dateFormat: "yy-mm-dd", monthNames: [ "一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月" ], dayNamesMin: [ "日", "一", "二", "三", "四", "五", "六" ]
                };
                //为ID为begin_time的input设置日历
                $("#updatetime").datepicker(dateFormat);
            });
        </script>
    </td>

</tr>
<tr>
    <th>点击</th>
    <td>
        <input type="text" name="click" class="w100" value="100"/> 次
    </td>
</tr>

<list from="$user_field" name="f">
    {$f.html}
</list>
<tr>
    <th>模板</th>
    <td>
        <input class="w200" type="text" value="" name="template">
        <button class="select_tpl" action="template" type="button">选择列表模板</button>
        <span class="validation">{style}指模板风格,不设置将使用栏目模板</span>
    </td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="btn_send">
    <input type="submit" class="btn" value="确定"/>
</div>
</form>
</body>
</html>